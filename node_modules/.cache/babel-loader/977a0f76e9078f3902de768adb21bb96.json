{"ast":null,"code":"'use strict';\n\nfunction buildRange(item) {\n  return {\n    start: item,\n    count: 1\n  };\n}\n\nfunction completeRangeWithItem(range, item) {\n  range.end = item;\n  range.step = item - range.start;\n  range.count = 2;\n}\n\nfunction finalizeCurrentRange(results, currentRange, currentItemRange) {\n  if (currentRange) {\n    // Two elements do not form a range so split them into 2 single elements\n    if (currentRange.count === 2) {\n      results.push(buildRange(currentRange.start));\n      results.push(buildRange(currentRange.end));\n    } else {\n      results.push(currentRange);\n    }\n  }\n\n  if (currentItemRange) {\n    results.push(currentItemRange);\n  }\n}\n\nfunction compactField(arr) {\n  var results = [];\n  var currentRange = undefined;\n\n  for (var i = 0; i < arr.length; i++) {\n    var currentItem = arr[i];\n\n    if (typeof currentItem !== 'number') {\n      // String elements can't form a range\n      finalizeCurrentRange(results, currentRange, buildRange(currentItem));\n      currentRange = undefined;\n    } else if (!currentRange) {\n      // Start a new range\n      currentRange = buildRange(currentItem);\n    } else if (currentRange.count === 1) {\n      // Guess that the current item starts a range\n      completeRangeWithItem(currentRange, currentItem);\n    } else {\n      if (currentRange.step === currentItem - currentRange.end) {\n        // We found another item that matches the current range\n        currentRange.count++;\n        currentRange.end = currentItem;\n      } else if (currentRange.count === 2) {\n        // The current range can't be continued\n        // Break the first item of the current range into a single element, and try to start a new range with the second item\n        results.push(buildRange(currentRange.start));\n        currentRange = buildRange(currentRange.end);\n        completeRangeWithItem(currentRange, currentItem);\n      } else {\n        // Persist the current range and start a new one with current item\n        finalizeCurrentRange(results, currentRange);\n        currentRange = buildRange(currentItem);\n      }\n    }\n  }\n\n  finalizeCurrentRange(results, currentRange);\n  return results;\n}\n\nmodule.exports = compactField;","map":null,"metadata":{},"sourceType":"script"}